"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),require("../../utils/env");const jsonwebtoken_1=__importDefault(require("jsonwebtoken")),crypto_1=__importDefault(require("crypto")),debug_util_1=__importDefault(require("../../utils/debug.util")),log=(0,debug_util_1.default)("app:auth-controller"),jwtSecret=process.env.JWT_SECRET,tokenExpirationInSeconds=parseInt(process.env.TOKEN_EXPIRATION,10);class AuthController{async createJwt(e,t){try{const r=`${e.body.userId}${jwtSecret}`,o=crypto_1.default.createSecretKey(crypto_1.default.randomBytes(16)),s=crypto_1.default.createHmac("sha512",o).update(r).digest("base64");e.body.refreshKey=o.export();const n=jsonwebtoken_1.default.sign(e.body,jwtSecret,{expiresIn:tokenExpirationInSeconds});return t.status(201).send({accessToken:n,refreshToken:s})}catch(e){return log("createJwt error: %O",e),t.status(500).send()}}}exports.default=new AuthController;