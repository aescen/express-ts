"use strict";var _UsersDao_instances,_UsersDao_users,_UsersDao_allowedPatchedFields,_UsersDao_getPatchedUser,__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(e,s,t,a){if("a"===t&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof s?e!==s||!a:!s.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?a:"a"===t?a.call(e):a?a.value:s.get(e)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const shortid_1=__importDefault(require("shortid")),debug_1=__importDefault(require("debug")),log=(0,debug_1.default)("app:in-memory-dao");class UsersDao{constructor(){_UsersDao_instances.add(this),_UsersDao_users.set(this,[]),_UsersDao_allowedPatchedFields.set(this,["password","firstName","lastName","permissionLevel"]),log("created a new instance of UsersDao")}async addUser(e){return e.id=shortid_1.default.generate(),__classPrivateFieldGet(this,_UsersDao_users,"f").push(e),e.id}async getUsers(){return __classPrivateFieldGet(this,_UsersDao_users,"f")}async getUserById(e){return __classPrivateFieldGet(this,_UsersDao_users,"f").find((s=>s.id===e))??null}async getUserByEmail(e){return __classPrivateFieldGet(this,_UsersDao_users,"f").find((s=>s.email===e))??null}async updateUserById(e,s){const t=__classPrivateFieldGet(this,_UsersDao_users,"f").findIndex((s=>s.id===e));return __classPrivateFieldGet(this,_UsersDao_users,"f").splice(t,1,s),`${e} updated via put`}async partialUpdateUserById(e,s){const t=__classPrivateFieldGet(this,_UsersDao_users,"f").findIndex((s=>s.id===e)),a=__classPrivateFieldGet(this,_UsersDao_users,"f")[t],r=__classPrivateFieldGet(this,_UsersDao_instances,"m",_UsersDao_getPatchedUser).call(this,a,s);return __classPrivateFieldGet(this,_UsersDao_users,"f").splice(t,1,r),`${e} patched`}async deleteUserByUserId(e){const s=__classPrivateFieldGet(this,_UsersDao_users,"f").findIndex((s=>s.id===e));return __classPrivateFieldGet(this,_UsersDao_users,"f").splice(s,1),`${e} deleted`}}_UsersDao_users=new WeakMap,_UsersDao_allowedPatchedFields=new WeakMap,_UsersDao_instances=new WeakSet,_UsersDao_getPatchedUser=function(e,s){for(let t=0;t<__classPrivateFieldGet(this,_UsersDao_allowedPatchedFields,"f").length;t+=1){const a=__classPrivateFieldGet(this,_UsersDao_allowedPatchedFields,"f")[t];a in s&&(e[a]=s[a])}return e},exports.default=new UsersDao;